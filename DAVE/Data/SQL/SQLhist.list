SELECT * FROM SONARDBA.STORY_CMPNY
WHERE CMPNY_ID IN (922106, 3193010)<#>
SELECT * FROM SONARDBA.STORY_CMPNY
WHERE CMPNY_ID IN (3193012,	3193011)<#>
SELECT * FROM SONARDBA.BREAK
WHERE BREAK_DT = '20-AUG-2013'
AND THETA_USE_CD = 'PRD'
and BREAK_CTGRY_ID = 1<#>
SELECT * FROM SONARDBA.BREAK
WHERE BREAK_DT = '19-AUG-2013'
AND THETA_USE_CD = 'PRD'
and BREAK_CTGRY_ID = 1<#>
SELECT * FROM SONARDBA.BREAK
WHERE BREAK_DT <= '19-AUG-2013'
AND BREAK_DT >=  '19-JUL-2013'
AND THETA_USE_CD = 'PRD'
and BREAK_CTGRY_ID = 1<#>
SELECT * FROM SONARDBA.BREAK
WHERE BREAK_DT <= '19-AUG-2013'
AND BREAK_DT >=  '19-JUL-2013'
AND THETA_USE_CD = 'PRD'
AND BREAK_CTGRY_ID = 1
AND (BREAK_DT, ISSUE_SYM_ID) IN (SELECT TRD_DT, ISSUE_SYM_ID FROM SONARDBA.MTRL_NEWS_RPT)
AND THETA_EQTN_HS_ID IN 
(select THETA_EQTN_HS_ID from sonardba.THETA_EQTN_HS where THETA_EQTN_ID in
(select THETA_EQTN_ID from sonardba.THETA_EQTN y where Y.DMN_TYPE_ID = 1))<#>
select 1 from dual<#test>
SELECT * FROM SONARDBA.BREAK
WHERE BREAK_DT <= '19-AUG-2013'
AND BREAK_DT >=  '19-JUL-2013'
AND THETA_USE_CD = 'PRD'
AND BREAK_CTGRY_ID = 1
AND (BREAK_DT, ISSUE_SYM_ID) IN (SELECT TRD_DT, ISSUE_SYM_ID FROM SONARDBA.MTRL_NEWS_RPT)
AND THETA_EQTN_HS_ID IN 
(select THETA_EQTN_HS_ID from sonardba.THETA_EQTN_HS where THETA_EQTN_ID in
(select THETA_EQTN_ID from sonardba.THETA_EQTN y where Y.DMN_TYPE_ID = 1))<#ITBreakBreaks>
SELECT B.break_dt, B.ORG_ID, B.ISSUE_SYM_ID, B.MKT_CLASS_CD,
B.THETA_EQTN_HS_ID, B.BREAK_ID, MNR.NEWS_EVENT_CD,
MNR.NEWS_RFRNC_ID, MNR.VISTA_NEWS_ID  FROM SONARDBA.BREAK B
INNER JOIN SONARDBA.MTRL_NEWS_RPT MNR
ON B.BREAK_DT = MNR.TRD_DT
and b.issue_sym_id = MNR.issue_sym_id
WHERE BREAK_DT <= '19-AUG-2013'
AND BREAK_DT >=  '19-JUL-2013'
AND THETA_USE_CD = 'PRD'
AND BREAK_CTGRY_ID = 1
AND THETA_EQTN_HS_ID IN 
(select THETA_EQTN_HS_ID from sonardba.THETA_EQTN_HS where THETA_EQTN_ID in
(select THETA_EQTN_ID from sonardba.THETA_EQTN y where Y.DMN_TYPE_ID = 1))<#ITBreakJoinMNR>
SELECT * FROM SONARDBA.BREAK
WHERE BREAK_DT <= '19-AUG-2013'
AND BREAK_DT >=  '19-JUL-2013'
AND THETA_USE_CD = 'PRD'
AND BREAK_CTGRY_ID = 1
AND (BREAK_DT, ISSUE_SYM_ID) IN (SELECT TRD_DT, ISSUE_SYM_ID FROM SONARDBA.MTRL_NEWS_RPT)
AND THETA_EQTN_HS_ID IN 
(select THETA_EQTN_HS_ID from sonardba.THETA_EQTN_HS where THETA_EQTN_ID in
(select THETA_EQTN_ID from sonardba.THETA_EQTN y where Y.DMN_TYPE_ID = 1))<#ITBreakJoinMNR>
SELECT BREAK_DT, COUNT(*) FROM SONARDBA.BREAK
WHERE BREAK_DT <= '19-AUG-2013'
AND BREAK_DT >=  '19-JUL-2013'
AND THETA_USE_CD = 'PRD'
AND BREAK_CTGRY_ID = 1
AND (BREAK_DT, ISSUE_SYM_ID) IN (SELECT TRD_DT, ISSUE_SYM_ID FROM SONARDBA.MTRL_NEWS_RPT)
AND THETA_EQTN_HS_ID IN 
(select THETA_EQTN_HS_ID from sonardba.THETA_EQTN_HS where THETA_EQTN_ID in
(SELECT THETA_EQTN_ID FROM SONARDBA.THETA_EQTN Y WHERE Y.DMN_TYPE_ID = 1))
group by break_dt<#BreakCounts>
SELECT BREAK_DT, THETA_EQTN_HS_ID, COUNT(*) FROM SONARDBA.BREAK
WHERE BREAK_DT <= '19-AUG-2013'
AND BREAK_DT >=  '19-JUL-2013'
AND THETA_USE_CD = 'PRD'
AND BREAK_CTGRY_ID = 1
AND (BREAK_DT, ISSUE_SYM_ID) IN (SELECT TRD_DT, ISSUE_SYM_ID FROM SONARDBA.MTRL_NEWS_RPT)
AND THETA_EQTN_HS_ID IN 
(select THETA_EQTN_HS_ID from sonardba.THETA_EQTN_HS where THETA_EQTN_ID in
(SELECT THETA_EQTN_ID FROM SONARDBA.THETA_EQTN Y WHERE Y.DMN_TYPE_ID = 1))
GROUP BY BREAK_DT, THETA_EQTN_HS_ID
ORDER BY BREAK_DT, THETA_EQTN_HS_ID<#>
SELECT * FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
and story_ts < '07-sep-13')<#3Q_NSNER>
select * from (
SELECT TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, CMPNY_ID FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
UNION 
SELECT TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, scndy_cmpny_1_id FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
AND SCNDY_CMPNY_1_ID IS NOT NULL
union
SELECT TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, scndy_cmpny_2_id FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
AND SCNDY_CMPNY_2_ID IS NOT NULL) NSNER
INNER JOIN SONARDBA.CMPNY_ORG CO
ON NSNER.CMPNY_ID = CO.CMPNY_ID<#3Q_ORG>
select nsner.*, iss.org_id, SC.CMPNY_NM, ISS.ISSUE_NM from (
SELECT TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, CMPNY_ID FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
UNION 
SELECT TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, scndy_cmpny_1_id FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
AND SCNDY_CMPNY_1_ID IS NOT NULL
union
SELECT TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, scndy_cmpny_2_id FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
AND SCNDY_CMPNY_2_ID IS NOT NULL) NSNER
INNER JOIN SONARDBA.CMPNY_ORG CO
ON NSNER.CMPNY_ID = CO.CMPNY_ID
INNER JOIN SONARDBA.STORY_CMPNY SC
ON SC.CMPNY_ID = CO.CMPNY_ID
INNER JOIN SONARDBA.ISSUE_DETAIL ISS
on iss.nm_id = co.nm_id<#3Q_ORG_nm>
SELECT NSNER.*, ISS.ORG_ID, SC.CMPNY_NM, ISS.ISSUE_NM FROM (
SELECT NEWS_RFRNC_ID, TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, CMPNY_ID FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
UNION 
SELECT NEWS_RFRNC_ID,TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, scndy_cmpny_1_id FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
AND SCNDY_CMPNY_1_ID IS NOT NULL
UNION
SELECT NEWS_RFRNC_ID,TOKEN_PSTN_CT, SNTNC_PSTN_CT, TEXT_MNNG_RULE_CD, NEWS_EVENT_CD, scndy_cmpny_2_id FROM SONaRDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (
SELECT news_story_id FROM sonardba.NEWS_STORY
WHERE STORY_TS >= '06-SEP-13'
AND STORY_TS < '07-sep-13')
AND SCNDY_CMPNY_2_ID IS NOT NULL) NSNER
INNER JOIN SONARDBA.CMPNY_ORG CO
ON NSNER.CMPNY_ID = CO.CMPNY_ID
INNER JOIN SONARDBA.STORY_CMPNY SC
ON SC.CMPNY_ID = CO.CMPNY_ID
INNER JOIN SONARDBA.ISSUE_DETAIL ISS
on iss.nm_id = co.nm_id<#3Q_ORG_nm2>
SELECT VISTA_NEWS_ID, STORY_TS, SUM(CNT + CNT1 + CNT2) FROM (
SELECT VISTA_NEWS_ID, story_ts, COUNT(DISTINCT CO.ORG_ID) CNT, COUNT(DISTINCT CO1.ORG_ID) CNT1, COUNT(DISTINCT CO2.ORG_ID) CNT2 
FROM SONARDBA.NEWS_STORY NS
INNER JOIN SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
ON NS.NEWS_STORY_ID = NSNER.NEWS_STORY_ID
INNER JOIN SONARDBA.CMPNY_ORG CO
ON NSNER.CMPNY_ID = CO.CMPNY_ID
INNER JOIN SONARDBA.CMPNY_ORG CO1
ON NSNER.SCNDY_CMPNY_1_ID = CO1.CMPNY_ID
INNER JOIN SONARDBA.CMPNY_ORG CO2
ON NSNER.SCNDY_CMPNY_2_ID = CO2.CMPNY_ID
WHERE  STORY_TS > '05-SEP-13' 
AND STORY_TS <  '17-SEP-13'
GROUP BY NS.VISTA_NEWS_ID, STORY_TS)
group by VISTA_NEWS_ID, story_ts<#3Q_Counts>
SELECT VISTA_NEWS_ID, STORY_TS, SUM(CNT + CNT1 + CNT2) FROM (
SELECT VISTA_NEWS_ID, trunc(story_ts, 'DD') story_ts, COUNT(DISTINCT CO.ORG_ID) CNT, COUNT(DISTINCT CO1.ORG_ID) CNT1, COUNT(DISTINCT CO2.ORG_ID) CNT2 
FROM SONARDBA.NEWS_STORY NS
INNER JOIN SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
ON NS.NEWS_STORY_ID = NSNER.NEWS_STORY_ID
left JOIN SONARDBA.CMPNY_ORG CO
ON NSNER.CMPNY_ID = CO.CMPNY_ID
left JOIN SONARDBA.CMPNY_ORG CO1
ON NSNER.SCNDY_CMPNY_1_ID = CO1.CMPNY_ID
left JOIN SONARDBA.CMPNY_ORG CO2
ON NSNER.SCNDY_CMPNY_2_ID = CO2.CMPNY_ID
WHERE  STORY_TS BETWEEN '05-SEP-13' AND '17-SEP-13'
GROUP BY NS.VISTA_NEWS_ID,  trunc(story_ts, 'DD'))
group by VISTA_NEWS_ID, story_ts<#3Q_Counts2>
SELECT DISTINCT TRIM(VISTA_NEWS_ID) VISTA_NEWS_ID, ORG_ID, news_rfrnc_id FROM SONARDBA.MTRL_NEWS_RPT MNR
JOIN SONARDBA.ISSUE_DETAIL ISS
on iss.issue_id =  mnr.issue_id
WHERE TRD_DT BETWEEN '06-SEP-13' AND '16-SEP-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT<#>
SELECT DISTINCT TRIM(VISTA_NEWS_ID) VISTA_NEWS_ID, ISS.ORG_ID, MNR.news_rfrnc_id, CO.CMPNY_ID FROM SONARDBA.MTRL_NEWS_RPT MNR
JOIN SONARDBA.ISSUE_DETAIL ISS
ON ISS.ISSUE_ID =  MNR.ISSUE_ID
 INNER JOIN  SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
 ON MNR.NEWS_RFRNC_ID = NSNER.NEWS_RFRNC_ID
 INNER JOIN  SONARDBA.CMPNY_ORG CO
 ON ISS.ORG_ID = CO.ORG_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '16-SEP-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT
AND CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)<#>
SELECT DISTINCT TRIM(VISTA_NEWS_ID) VISTA_NEWS_ID, ISS.ORG_ID, MNR.news_rfrnc_id, CO.CMPNY_ID, CO.NM_ID, CO.DESC_NM_ID  FROM SONARDBA.MTRL_NEWS_RPT MNR
JOIN SONARDBA.ISSUE_DETAIL ISS
ON ISS.ISSUE_ID =  MNR.ISSUE_ID
 INNER JOIN  SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
 ON MNR.NEWS_RFRNC_ID = NSNER.NEWS_RFRNC_ID
 INNER JOIN  SONARDBA.CMPNY_ORG CO
 ON ISS.ORG_ID = CO.ORG_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '16-SEP-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT
AND CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)<#>
SELECT DISTINCT TRIM(VISTA_NEWS_ID) VISTA_NEWS_ID, ISS.ORG_ID, MNR.news_rfrnc_id, CO.CMPNY_ID, CO.NM_ID  FROM SONARDBA.MTRL_NEWS_RPT MNR
JOIN SONARDBA.ISSUE_DETAIL ISS
ON ISS.ISSUE_ID =  MNR.ISSUE_ID
 INNER JOIN  SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
 ON MNR.NEWS_RFRNC_ID = NSNER.NEWS_RFRNC_ID
 INNER JOIN  SONARDBA.CMPNY_ORG CO
 ON ISS.ORG_ID = CO.ORG_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '16-SEP-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT
AND CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)<#>
SELECT DISTINCT TRIM(VISTA_NEWS_ID) VISTA_NEWS_ID, ISS.ORG_ID, MNR.news_rfrnc_id, CO.CMPNY_ID, CO.NM_ID  FROM SONARDBA.MTRL_NEWS_RPT MNR
JOIN SONARDBA.ISSUE_DETAIL ISS
ON ISS.ISSUE_ID =  MNR.ISSUE_ID
 INNER JOIN  SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
 ON MNR.NEWS_RFRNC_ID = NSNER.NEWS_RFRNC_ID
 INNER JOIN  SONARDBA.CMPNY_ORG CO
 ON ISS.ORG_ID = CO.ORG_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT
AND CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)<#>
SELECT * FROM ISSUE_DETAIL
WHERE ORG_ID IN ('60000006')
and current_date BETWEEN EFCTV_DT and XPRTN_DT<#>
SELECT * FROM sonardba.ISSUE_DETAIL
WHERE ORG_ID IN ('60000006')
and current_date BETWEEN EFCTV_DT and XPRTN_DT<#>
SELECT * FROM CMPNY_ORG
where CMPNY_ID = 3215256<#>
SELECT * FROM sonardba.CMPNY_ORG
where CMPNY_ID = 3184541<#>
SELECT a.VISTA_NEWS_ID, a.org_id, SC.CMPNY_NM, COI.CMPNY_NM rfrnc_NM, NS.STORY_HDLN_TX, NS.STORY_BODY_BK, a.news_rfrnc_id , CO.CMPNY_ID from(
select distinct TRIM(VISTA_NEWS_ID) VISTA_NEWS_ID, ISS.ORG_ID, MNR.news_rfrnc_id 
FROM SONARDBA.MTRL_NEWS_RPT MNR
JOIN SONARDBA.ISSUE_DETAIL ISS
ON ISS.ISSUE_ID =  MNR.ISSUE_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT) A
 INNER JOIN  SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
 ON A.NEWS_RFRNC_ID = NSNER.NEWS_RFRNC_ID
 LEFT JOIN  SONARDBA.CMPNY_ORG CO
 ON A.ORG_ID = CO.ORG_ID
 INNER JOIN STORY_CMPNY SC
 ON SC.CMPNY_ID = CO.CMPNY_ID
 INNER JOIN CMPNY_ORG_ID COI
 ON CO.NM_ID = COI.NM_ID
 AND CO.DESC_NM_ID = COI.DESC_NM_ID
  INNER JOIN (SELECT NEWS_STORY_ID, STORY_HDLN_TX, STORY_BODY_BK 
 FROM SONARDBA.NEWS_STORY
 WHERE STORY_TS BETWEEN '05-SEP-13' AND '08-OCT-13') NS
  on NSNER.NEWS_STORY_ID = NS.NEWS_STORY_ID
where CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)<#>
SELECT a.VISTA_NEWS_ID, a.org_id, SC.CMPNY_NM, ISS2.ISSUE_NM, ns.STORY_HDLN_TX, NS.STORY_BODY_BK,  a.news_rfrnc_id , CO.CMPNY_ID from(
select distinct TRIM(VISTA_NEWS_ID) VISTA_NEWS_ID, ISS.ORG_ID, MNR.news_rfrnc_id 
FROM SONARDBA.MTRL_NEWS_RPT MNR
JOIN SONARDBA.ISSUE_DETAIL ISS
ON ISS.ISSUE_ID =  MNR.ISSUE_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT) A
 INNER JOIN  SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
 ON A.NEWS_RFRNC_ID = NSNER.NEWS_RFRNC_ID
 left JOIN  SONARDBA.CMPNY_ORG CO
 ON A.ORG_ID = CO.ORG_ID
 INNER JOIN SONARDBA.STORY_CMPNY SC
 ON SC.CMPNY_ID = CO.CMPNY_ID
 INNER JOIN SONARDBA.ISSUE_DETAIL ISS2
 ON CO.NM_ID = ISS2.NM_ID
 INNER JOIN (SELECT NEWS_STORY_ID, STORY_HDLN_TX, STORY_BODY_BK 
 FROM SONARDBA.NEWS_STORY
 WHERE STORY_TS BETWEEN '05-SEP-13' AND '08-OCT-13') NS
 on NSNER.NEWS_STORY_ID = NS.NEWS_STORY_ID
where CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)<#>
select distinct TRD_DT from MNR_NEW_PEA2<#New_PEA>
SELECT * FROM MTRL_NEWS_RPT
where TRD_DT between '19-JUL-13' and '20-AUG-13'<#OLD_PEA>
SELECT * FROM MNR_NEW_PEA2
where TRD_DT =  '23-JUL-13'<#new_PEA2>
SELECT * FROM MTRL_NEWS_RPT
where TRD_DT =  '23-JUL-13'<#OLD_PEA2>
--PROD Missing in 3Q
SELECT distinct ISS.org_id, MNR.TRD_DT, MNR.NEWS_EVENT_CD, mnr.vista_news_id, sc.cmpny_nm, iss.issue_nm, ns.story_hdln_tx FROM SONARDBA.MTRL_NEWS_RPT@SONARP MNR
INNER JOIN SONARDBA.ISSUE_DETAIL@SONARP ISS
ON MNR.ISSUE_SYM_ID = ISS.ISSUE_SYM_ID
inner JOIN (SELECT SUBSTR (VISTA_NEWS_ID, 1, 49) VISTA_NEWS_ID,
                      STORY_HDLN_TX,
                      NEWS_STORY_ID
                 FROM SONARDBA.NEWS_STORY@SONARP
                WHERE STORY_TS >= '06-SEP-2013' AND STORY_TS < '08-OCT-2013') NS
ON trim(mnr.VISTA_NEWS_ID) = NS.VISTA_NEWS_ID
INNER JOIN SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC@SONARP NSNER
ON NSNER.NEWS_RFRNC_ID = MNR.NEWS_RFRNC_ID
INNER JOIN SONARDBA.CMPNY_ORG@SONARP CO
ON CO.ORG_ID = iss.ORG_ID
INNER JOIN SONARDBA.STORY_CMPNY@SONARP SC
on sc.cmpny_id = co.cmpny_id
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT
and mnr.news_rfrnc_id not in (
select  news_rfrnc_id from (SELECT ISS.org_id, MNR.TRD_DT, MNR.NEWS_EVENT_CD, mnr.news_rfrnc_id FROM SONARDBA.MTRL_NEWS_RPT@SONARP MNR
INNER JOIN SONARDBA.ISSUE_DETAIL@SONARP ISS
ON MNR.ISSUE_SYM_ID = ISS.ISSUE_SYM_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT) PROD
INNER JOIN  
 (SELECT ISS.org_id, MNR.TRD_DT, MNR.NEWS_EVENT_CD FROM MTRL_NEWS_RPT MNR
INNER JOIN ISSUE_DETAIL ISS
ON MNR.ISSUE_SYM_ID = ISS.ISSUE_SYM_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT) PAR
ON PROD.ORG_ID = PAR.ORG_ID
AND PROD.TRD_DT = PAR.TRD_DT
AND PROD.NEWS_EVENT_CD = PAR.NEWS_EVENT_CD)
and CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)
AND MNR.NEWS_EVENT_CD <> 4<#3Q_All_Data>
select 1 from dual<#BLANK>
--PROD Missing in 3Q
SELECT distinct ISS.org_id, MNR.TRD_DT, MNR.NEWS_EVENT_CD, mnr.vista_news_id, sc.cmpny_nm, iss.issue_nm, ns.story_hdln_tx FROM SONARDBA.MTRL_NEWS_RPT MNR
INNER JOIN SONARDBA.ISSUE_DETAIL ISS
ON MNR.ISSUE_SYM_ID = ISS.ISSUE_SYM_ID
inner JOIN (SELECT SUBSTR (VISTA_NEWS_ID, 1, 49) VISTA_NEWS_ID,
                      STORY_HDLN_TX,
                      NEWS_STORY_ID
                 FROM SONARDBA.NEWS_STORY
                WHERE STORY_TS >= '06-SEP-2013' AND STORY_TS < '08-OCT-2013') NS
ON trim(mnr.VISTA_NEWS_ID) = NS.VISTA_NEWS_ID
INNER JOIN SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER
ON NSNER.NEWS_RFRNC_ID = MNR.NEWS_RFRNC_ID
INNER JOIN SONARDBA.CMPNY_ORG CO
ON CO.ORG_ID = iss.ORG_ID
INNER JOIN SONARDBA.STORY_CMPNY SC
on sc.cmpny_id = co.cmpny_id
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT
and mnr.news_rfrnc_id not in (
select  news_rfrnc_id from (SELECT ISS.org_id, MNR.TRD_DT, MNR.NEWS_EVENT_CD, mnr.news_rfrnc_id FROM SONARDBA.MTRL_NEWS_RPT@SONARP MNR
INNER JOIN SONARDBA.ISSUE_DETAIL ISS
ON MNR.ISSUE_SYM_ID = ISS.ISSUE_SYM_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT) PROD
INNER JOIN  
 (SELECT ISS.org_id, MNR.TRD_DT, MNR.NEWS_EVENT_CD FROM sonardba.MTRL_NEWS_RPT@sonarp MNR
INNER JOIN sonardba.ISSUE_DETAIL@sonarp ISS
ON MNR.ISSUE_SYM_ID = ISS.ISSUE_SYM_ID
WHERE TRD_DT BETWEEN '06-SEP-13' AND '07-OCT-13'
AND MNR.STORY_DT BETWEEN ISS.EFCTV_DT AND ISS.XPRTN_DT) PAR
ON PROD.ORG_ID = PAR.ORG_ID
AND PROD.TRD_DT = PAR.TRD_DT
AND PROD.NEWS_EVENT_CD = PAR.NEWS_EVENT_CD)
and CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)
AND MNR.NEWS_EVENT_CD <> 4<#3Q_missing>
SELECT DISTINCT FEED_TYPE, DJ.BREAK_DT, EVENT_CD, DJ.ORG_ID FROM(
SELECT DISTINCT CASE FEED_TYPE
                  WHEN 'F'
                  THEN 100
                  WHEN 'S'
                  THEN 10
                  WHEN 'E'
                  THEN 1
                  ELSE NULL
                END FEED_TYPE,
TRUNC(CREATE_DATE + 0.34375, 'DD') BREAK_DT, 
CASE
                  WHEN EVENT_TYPE = 'BANKRUPTCY'
                  THEN -1
                  WHEN EVENT_TYPE = 'EARNINGS'
                  THEN 1
                  WHEN EVENT_TYPE = 'EARNINGS_DETAIL'
                  THEN 1
                  WHEN EVENT_TYPE = 'FDA'
                  THEN 2
                  WHEN EVENT_TYPE = 'FINANCIALANNOUNCEMENT'
                  THEN 1
                  WHEN EVENT_TYPE = 'MERGER'
                  THEN 3
                  WHEN EVENT_TYPE = 'MAANDTAKEOVERS'
                  THEN 3
                  WHEN EVENT_TYPE = 'MERGERACQUISITION'
                  THEN 3
                  WHEN EVENT_TYPE = 'PRODUCTANNOUNCEMENT'
                  THEN 0
                  ELSE NULL
                END EVENT_CD, org_id FROM DJ_EVENT_FLTR FLTR
INNER JOIN DJ_COMP_LND COMP
ON FLTR.EVENT_ID = COMP.EVENT_ID
INNER JOIN  CMPNY_ORG
ON COMP.CMPNY_ID = CMPNY_ORG.CMPNY_ID) DJ
WHERE DJ.EVENT_CD IS NOT NULL
AND DJ.BREAK_DT BETWEEN '19-JUL-13' AND '20-AUG-13'<#2Q_AllEvent>
SELECT * FROM (
SELECT TRUNC(NS.STORY_TS + 0.34375, 'DD') BREAK_DT, LFT.NEWS_EVENT_CD, LFT.ORG_ID  FROM SONARDBA.NEWS_STORY NS
INNER JOIN (SELECT NEWS_STORY_ID, NEWS_EVENT_CD, ORG_ID 
FROM SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER,
              SONARDBA.CMPNY_ORG CO
WHERE NSNER.CREAT_TS BETWEEN '18-JUL-13' AND '21-AUG-13'
AND CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)) LFT
ON LFT.NEWS_STORY_ID = NS.NEWS_STORY_ID
WHERE NS.STORY_TS BETWEEN '18-JUL-13' AND '21-AUG-13')
WHERE BREAK_DT BETWEEN '19-JUL-13' AND '20-AUG-13'
AND ORG_ID IS NOT NULL
AND NEWS_EVENT_CD IN (0,1,2,3)<#PROD_AllEvent>
SELECT distinct * FROM (
SELECT TRUNC(NS.STORY_TS + 0.34375, 'DD') BREAK_DT, LFT.NEWS_EVENT_CD, LFT.ORG_ID  FROM SONARDBA.NEWS_STORY NS
INNER JOIN (SELECT NEWS_STORY_ID, NEWS_EVENT_CD, ORG_ID 
FROM SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC NSNER,
              SONARDBA.CMPNY_ORG CO
WHERE NSNER.CREAT_TS BETWEEN '18-JUL-13' AND '21-AUG-13'
AND CO.CMPNY_ID IN (NSNER.CMPNY_ID, NSNER.SCNDY_CMPNY_1_ID, NSNER.SCNDY_CMPNY_2_ID, NSNER.SCNDY_CMPNY_3_ID)) LFT
ON LFT.NEWS_STORY_ID = NS.NEWS_STORY_ID
WHERE NS.STORY_TS BETWEEN '18-JUL-13' AND '21-AUG-13')
WHERE BREAK_DT BETWEEN '19-JUL-13' AND '20-AUG-13'
AND ORG_ID IS NOT NULL
AND NEWS_EVENT_CD IN (0,1,2,3)<#PROD_AllEvent>
SELECT * FROM SONARDBA.MTRL_NEWS_RPT
WHERE trd_dt BETWEEN '03-MAR-2014' AND '04-APR-2014'
and news_event_cd = 3<#MNR_MERG>
SELECT news_rfrnc_id, CHK_UNIQUE, prev_rfrnc_id FROM SONARDBA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE event_dt BETWEEN '03-MAR-2014' AND '04-APR-2014'
and news_event_cd = 3<#nsner_2d>
SELECT news_rfrnc_id, CHK_UNIQUE, NEWS_RFRNC_ID FROM SONARdbA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (SELECT NEWS_STORY_ID FROM SONARDBA.NEWS_STORY
WHERE STORY_TS BETWEEN '02-MAR-2014' AND '05-APR-2014' )
AND NEWS_EVENT_CD = 3<#nsner_p>
SELECT news_rfrnc_id, CHK_UNIQUE, prev_rfrnc_id FROM SONARdbA.NEWS_STORY_NEWS_EVENT_REFERENC
WHERE NEWS_STORY_ID IN (SELECT NEWS_STORY_ID FROM SONARDBA.NEWS_STORY
WHERE STORY_TS BETWEEN '02-MAR-2014' AND '05-APR-2014' )
AND NEWS_EVENT_CD = 3<#nsner_p>
SELECT TRD_DT, NEWS_EVENT_CD, COUNT(distinct NEWS_RFRNC_ID) FROM sonardba.MTRL_NEWS_RPT
WHERE TRD_DT >= '01-JAN-2014'
and trd_dt < '20-JUN-2014'
GROUP BY TRD_DT, NEWS_EVENT_CD
order by TRD_DT, NEWS_EVENT_CD<#BackLoad>
SELECT count(*) FROM SONARDBA.PBLSH_DAILY
where trd_dt = '23-JUN-2014'<#publsh_dly>
SELECT count(*) FROM SONARDBA.PBLSH_DAILY
where trd_dt = '23-JUN-2014'<#BackLoad>
SELECT count(*) FROM SONARDBA.PBLSH_LSTD_SM
where trd_dt = '23-JUN-2014'<#publsh_sm>
SELECT count(*) FROM SONARDBA.PBLSH_PRFL
where trd_dt = '23-JUN-2014'<#>
SELECT MKT_CLASS_CD, count(*) FROM BREAK
WHERE BREAK_DT = '23-JUN-2014'
group by mkt_class_cd<#>
SELECT MKT_CLASS_CD, count(*) FROM sonardba.BREAK
WHERE BREAK_DT = '23-JUN-2014'
group by mkt_class_cd<#>
SELECT MKT_CLASS_CD, count(*) FROM BREAK
WHERE BREAK_DT = '23-JUN-2014'
and THETA_USE_CD = 'PRD'
group by mkt_class_cd<#>
SELECT MKT_CLASS_CD, count(*) FROM sonardba.BREAK
WHERE BREAK_DT = '23-JUN-2014'
and THETA_USE_CD = 'PRD'
group by mkt_class_cd<#>
SELECT mkt_class_cd, count(*) FROM sonardba.NEWS_ISSUE_DAILY NID
INNER JOIN sonardba.ISSUE_DETAIL id
on NID.ISSUE_ID = id.ISSUE_ID
WHERE TRD_DT = '23-JUN-2014'
and NID.NEWS_EXSTC_FL = 'Y'
group by mkt_class_cd<#NID>
SELECT NEW_STORY_ID, ORG_ID FROM SONARDBA.NEWS_STORY_ISSUE
WHERE STORY_TS >= '18-SEP-2014' 
and STORY_TS < '19-SEP-2014'<#NSI>
SELECT distinct wrk.id, iss.org_id  FROM SONARDBA.CMPNY_MKT_WORK WRK
INNER JOIN (SELECT * FROM ISSUE_DETAIL WHERE CURRENT_DATE BETWEEN EFCTV_DT AND XPRTN_DT) ISS
ON ISS.ISSUE_SYM_ID = WRK.ISSUE_SYM_ID
where mkt_cd <> 'FOREIGN'<#Found>
SELECT NEWs_STORY_ID, ORG_ID FROM SONARDBA.NEWS_STORY_ISSUE
WHERE STORY_TS >= '18-SEP-2014' 
and STORY_TS < '19-SEP-2014'<#NSI>
SELECT NEWs_STORY_ID, ORG_ID FROM SONARDBA.NEWS_STORY_ISSUE
WHERE STORY_TS >= '30-SEP-2014' 
and STORY_TS < '01-OCT-2014'<#NSI>
SELECT ISSUE_SYM_ID,
NM_ID,
ISSUE_ID,
EFCTV_DT,
MKT_CLASS_CD,
XPRTN_DT,
SIC_CD,
CUSIP_ID,
ISSUE_TYPE_TX,
ORG_ID,
NASDQ_100_FL,
MKT_CNTR_CD,
TRD_SYM_ID,
SIAC_SYM_ID,
BOND_GRADE_CD,
CNVRB_FL,
TCKR_SYM_ID,
MTRTY_DT,
SHRT_SALE_XMPTN_CD FROM SONARDBA.ISSUE_DETAIL@SONARP
WHERE EFCTV_DT = '14-oct-2014'
MINUS
SELECT ISSUE_SYM_ID,
NM_ID,
ISSUE_ID,
EFCTV_DT,
MKT_CLASS_CD,
XPRTN_DT,
SIC_CD,
CUSIP_ID,
ISSUE_TYPE_TX,
ORG_ID,
NASDQ_100_FL,
MKT_CNTR_CD,
TRD_SYM_ID,
SIAC_SYM_ID,
BOND_GRADE_CD,
CNVRB_FL,
TCKR_SYM_ID,
MTRTY_DT,
SHRT_SALE_XMPTN_CD FROM ERD_OWNER.SONAR_ISSUE_DETAIL_VW@OATSQ
WHERE EFCTV_DT = '14-oct-2014'
ORDER BY NM_ID<#ORF_PROD_ONLY>
SELECT ISSUE_SYM_ID,
NM_ID,
ISSUE_ID,
EFCTV_DT,
MKT_CLASS_CD,
XPRTN_DT,
SIC_CD,
CUSIP_ID,
ISSUE_TYPE_TX,
ORG_ID,
NASDQ_100_FL,
MKT_CNTR_CD,
TRD_SYM_ID,
SIAC_SYM_ID,
BOND_GRADE_CD,
CNVRB_FL,
TCKR_SYM_ID,
MTRTY_DT,
SHRT_SALE_XMPTN_CD FROM ERD_OWNER.SONAR_ISSUE_DETAIL_VW@OATSQ
WHERE EFCTV_DT = '14-oct-2014'
MINUS 
SELECT ISSUE_SYM_ID,
NM_ID,
ISSUE_ID,
EFCTV_DT,
MKT_CLASS_CD,
XPRTN_DT,
SIC_CD,
CUSIP_ID,
ISSUE_TYPE_TX,
ORG_ID,
NASDQ_100_FL,
MKT_CNTR_CD,
TRD_SYM_ID,
SIAC_SYM_ID,
BOND_GRADE_CD,
CNVRB_FL,
TCKR_SYM_ID,
MTRTY_DT,
SHRT_SALE_XMPTN_CD FROM SONARDBA.ISSUE_DETAIL@SONARP
WHERE EFCTV_DT = '14-oct-2014'
ORDER BY NM_ID<#ORF_ERD_ONLY>
select * from :table<#>
SELECT ISSUE_SYM_ID,
NM_ID,
ISSUE_ID,
EFCTV_DT,
MKT_CLASS_CD,
XPRTN_DT,
SIC_CD,
CUSIP_ID,
ISSUE_TYPE_TX,
ORG_ID,
NASDQ_100_FL,
MKT_CNTR_CD,
TRD_SYM_ID,
SIAC_SYM_ID,
BOND_GRADE_CD,
CNVRB_FL,
TCKR_SYM_ID,
MTRTY_DT,
SHRT_SALE_XMPTN_CD FROM ERD_OWNER.SONAR_ISSUE_DETAIL_VW@OATSQ
WHERE EFCTV_DT = ':date'
MINUS 
SELECT ISSUE_SYM_ID,
NM_ID,
ISSUE_ID,
EFCTV_DT,
MKT_CLASS_CD,
XPRTN_DT,
SIC_CD,
CUSIP_ID,
ISSUE_TYPE_TX,
ORG_ID,
NASDQ_100_FL,
MKT_CNTR_CD,
TRD_SYM_ID,
SIAC_SYM_ID,
BOND_GRADE_CD,
CNVRB_FL,
TCKR_SYM_ID,
MTRTY_DT,
SHRT_SALE_XMPTN_CD FROM SONARDBA.ISSUE_DETAIL@SONARP
WHERE EFCTV_DT = ':date'
ORDER BY NM_ID<#ORF_ERD_ONLY>
SELECT ISSUE_SYM_ID,
NM_ID,
ISSUE_ID,
EFCTV_DT,
MKT_CLASS_CD,
XPRTN_DT,
SIC_CD,
CUSIP_ID,
ISSUE_TYPE_TX,
ORG_ID,
NASDQ_100_FL,
MKT_CNTR_CD,
TRD_SYM_ID,
SIAC_SYM_ID,
BOND_GRADE_CD,
CNVRB_FL,
TCKR_SYM_ID,
MTRTY_DT,
SHRT_SALE_XMPTN_CD FROM SONARDBA.ISSUE_DETAIL@SONARP
WHERE EFCTV_DT = ':date'
MINUS
SELECT ISSUE_SYM_ID,
NM_ID,
ISSUE_ID,
EFCTV_DT,
MKT_CLASS_CD,
XPRTN_DT,
SIC_CD,
CUSIP_ID,
ISSUE_TYPE_TX,
ORG_ID,
NASDQ_100_FL,
MKT_CNTR_CD,
TRD_SYM_ID,
SIAC_SYM_ID,
BOND_GRADE_CD,
CNVRB_FL,
TCKR_SYM_ID,
MTRTY_DT,
SHRT_SALE_XMPTN_CD FROM ERD_OWNER.SONAR_ISSUE_DETAIL_VW@OATSQ
WHERE EFCTV_DT = ':date'
ORDER BY NM_ID<#ORF_PROD_ONLY>
select * from reported_trade<#ORF_PROD_ONLY>
select * from sonardba.reported_trade<#ORF_PROD_ONLY>
select 1 from dual<#publsh_sm>
select 2 from dual<#ORF_PROD_ONLY>
select issue_sym_id, trd_sym_id, siac_sym_id, nm_id, issue_id, issue_nm, efctv_dt, load_dt, mkt_class_cd, xprtn_dt, sic_cd, cusip_id, 
issue_type_tx, org_id, orgn_cd, nasdq_100_fl, mkt_cntr_cd, mtrty_dt, cnvrb_fl, bond_grade_cd, tckr_sym_id, shrt_sale_xmptn_cd
FROM SONARNT.ISSUE_DETAIL_EXPECTED
minus
select issue_sym_id, trd_sym_id, siac_sym_id, nm_id, issue_id, issue_nm, efctv_dt, load_dt, mkt_class_cd, xprtn_dt, sic_cd, cusip_id, 
ISSUE_TYPE_TX, ORG_ID, ORGN_CD, NASDQ_100_FL, MKT_CNTR_CD, MTRTY_DT, CNVRB_FL, BOND_GRADE_CD, TCKR_SYM_ID, SHRT_SALE_XMPTN_CD
FROM SONARDBA.ISSUE_DETAIL<#ORF_PROD_ONLY>
select issue_sym_id, trd_sym_id, siac_sym_id, nm_id, issue_id, issue_nm, efctv_dt, load_dt, mkt_class_cd, xprtn_dt, sic_cd, cusip_id, 
ISSUE_TYPE_TX, ORG_ID, ORGN_CD, NASDQ_100_FL, MKT_CNTR_CD, MTRTY_DT, CNVRB_FL, BOND_GRADE_CD, TCKR_SYM_ID, SHRT_SALE_XMPTN_CD
FROM SONARDBA.ISSUE_DETAIL
minus
select issue_sym_id, trd_sym_id, siac_sym_id, nm_id, issue_id, issue_nm, efctv_dt, load_dt, mkt_class_cd, xprtn_dt, sic_cd, cusip_id, 
issue_type_tx, org_id, orgn_cd, nasdq_100_fl, mkt_cntr_cd, mtrty_dt, cnvrb_fl, bond_grade_cd, tckr_sym_id, shrt_sale_xmptn_cd
FROM SONARNT.ISSUE_DETAIL_EXPECTED<#ORF_PROD_ONLY>
